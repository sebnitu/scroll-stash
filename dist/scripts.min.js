this.ScrollStash=function(){"use strict";var t=function(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t},e=function(t){return t.replace(/-([a-z])/g,(function(t){return t[1].toUpperCase()}))};function r(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function n(e){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?r(Object(o),!0).forEach((function(r){t(e,r,o[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):r(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}return function(t){var r={};r.settings=n(n({},{autoInit:!1,dataScroll:"scroll-stash",dataAnchor:"scroll-stash-anchor",selectorAnchor:"",selectorAnchorParent:"",selectorTopElem:"",selectorBotElem:"",alignment:"nearest",behavior:"auto",anchorPadding:16,saveKey:"ScrollStash",throttleDelay:250,customEventPrefix:"scroll-stash:"}),t),r.scrolls=[],r.state={},r.ticking=!1,r.init=function(){r.scrolls=document.querySelectorAll("[data-".concat(r.settings.dataScroll,"]")),a(),r.scrolls.forEach((function(t){g(t),t.addEventListener("scroll",o,!1)}))},r.destroy=function(){r.scrolls.forEach((function(t){t.removeEventListener("scroll",o,!1)})),r.scrolls=[],r.state={},localStorage.removeItem(r.settings.saveKey)},r.showAnchor=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.settings.behavior;g(t,e)};var o=function(){r.ticking||(setTimeout(s,r.settings.throttleDelay),r.ticking=!0)},s=function(){c(),r.ticking=!1},c=function(){document.querySelectorAll("[data-".concat(r.settings.dataScroll,"]")).forEach((function(t){var n=t.dataset[e(r.settings.dataScroll)];n&&(r.state[n]=t.scrollTop)})),localStorage.setItem(r.settings.saveKey,JSON.stringify(r.state)),document.dispatchEvent(new CustomEvent(r.settings.customEventPrefix+"saved",{bubbles:!0,detail:r.state}))},a=function(){localStorage.getItem(r.settings.saveKey)?(r.state=JSON.parse(localStorage.getItem(r.settings.saveKey)),Object.keys(r.state).forEach((function(t){var e=document.querySelector("[data-".concat(r.settings.dataScroll,'="').concat(t,'"]'));e&&(e.scrollTop=r.state[t])})),document.dispatchEvent(new CustomEvent(r.settings.customEventPrefix+"applied",{bubbles:!0,detail:r.state}))):c()},i=function(t){var n=t.dataset[e(r.settings.dataAnchor)];if("false"==n||"ignore"==n)return null;if(n&&t.querySelector(n))return t.querySelector(n);var o=r.settings.selectorAnchor?t.querySelector(r.settings.selectorAnchor):null;if(o&&r.settings.selectorAnchorParent){var s=o.closest(r.settings.selectorAnchorParent);if(s)return s}return o||null},l=function(t,e){var n=r.settings.anchorPadding;if(r.settings.selectorTopElem){var o=t.querySelector(r.settings.selectorTopElem);o&&(n+=o.offsetHeight)}return e.offsetTop-n},u=function(t,e){var n=r.settings.anchorPadding;if(r.settings.selectorBotElem){var o=t.querySelector(r.settings.selectorBotElem);o&&(n+=o.offsetHeight)}return e.offsetTop-(t.offsetHeight-(e.offsetHeight+n))},f=function(t,e){switch(r.settings.alignment){case"start":return l(t,e);case"end":return u(t,e);case"nearest":return function(t,e){var r=l(t,e),n=u(t,e);return t.scrollTop>r?r:t.scrollTop<n&&n}(t,e);default:return!1}},g=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.settings.behavior,o=i(t);if(o){var s=f(t,o);if(!s)return!0;t.scroll({top:s,behavior:n}),t.dispatchEvent(new CustomEvent(r.settings.customEventPrefix+"anchor",{bubbles:!0,detail:{key:t.dataset[e(r.settings.dataScroll)],position:t.scrollTop}}))}};return r.settings.autoInit&&r.init(),r}}();
