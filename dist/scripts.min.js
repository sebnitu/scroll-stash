!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).ScrollStash=e()}(this,(function(){"use strict";var t=function(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t};var e=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")};function r(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var n=function(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t},o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function i(t,e,r){return t(r={path:e,exports:{},require:function(t,e){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==e&&r.path)}},r.exports),r.exports}var c=i((function(t){function e(r){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?t.exports=e=function(t){return typeof t}:t.exports=e=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(r)}t.exports=e})),a="Expected a function",u=/^\s+|\s+$/g,l=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,f=/^0o[0-7]+$/i,h=parseInt,p="object"==c(o)&&o&&o.Object===Object&&o,v="object"==("undefined"==typeof self?"undefined":c(self))&&self&&self.Object===Object&&self,d=p||v||Function("return this")(),y=Object.prototype.toString,b=Math.max,g=Math.min,m=function(){return d.Date.now()};function j(t,e,r){var n,o,i,c,u,l,s=0,f=!1,h=!1,p=!0;if("function"!=typeof t)throw new TypeError(a);function v(e){var r=n,i=o;return n=o=void 0,s=e,c=t.apply(i,r)}function d(t){return s=t,u=setTimeout(j,e),f?v(t):c}function y(t){var r=t-l;return void 0===l||r>=e||r<0||h&&t-s>=i}function j(){var t=m();if(y(t))return w(t);u=setTimeout(j,function(t){var r=e-(t-l);return h?g(r,i-(t-s)):r}(t))}function w(t){return u=void 0,p&&n?v(t):(n=o=void 0,c)}function E(){var t=m(),r=y(t);if(n=arguments,o=this,l=t,r){if(void 0===u)return d(l);if(h)return u=setTimeout(j,e),v(l)}return void 0===u&&(u=setTimeout(j,e)),c}return e=S(e)||0,O(r)&&(f=!!r.leading,i=(h="maxWait"in r)?b(S(r.maxWait)||0,e):i,p="trailing"in r?!!r.trailing:p),E.cancel=function(){void 0!==u&&clearTimeout(u),s=0,n=l=o=u=void 0},E.flush=function(){return void 0===u?c:w(m())},E}function O(t){var e=c(t);return!!t&&("object"==e||"function"==e)}function w(t){return"symbol"==c(t)||function(t){return!!t&&"object"==c(t)}(t)&&"[object Symbol]"==y.call(t)}function S(t){if("number"==typeof t)return t;if(w(t))return NaN;if(O(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=O(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(u,"");var r=s.test(t);return r||f.test(t)?h(t.slice(2),r?2:8):l.test(t)?NaN:+t}var E=function(t,e,r){var n=!0,o=!0;if("function"!=typeof t)throw new TypeError(a);return O(r)&&(n="leading"in r?!!r.leading:n,o="trailing"in r?!!r.trailing:o),j(t,e,{leading:n,maxWait:e,trailing:o})},T=i((function(t,e){var r=9007199254740991,n="[object Map]",i="[object Promise]",a="[object Set]",u="[object WeakMap]",l="[object DataView]",s=/^\[object .+?Constructor\]$/,f="object"==c(o)&&o&&o.Object===Object&&o,h="object"==("undefined"==typeof self?"undefined":c(self))&&self&&self.Object===Object&&self,p=f||h||Function("return this")(),v=e&&!e.nodeType&&e,d=v&&t&&!t.nodeType&&t,y=d&&d.exports===v;var b,g,m,j=Function.prototype,O=Object.prototype,w=p["__core-js_shared__"],S=(b=/[^.]+$/.exec(w&&w.keys&&w.keys.IE_PROTO||""))?"Symbol(src)_1."+b:"",E=j.toString,T=O.hasOwnProperty,P=O.toString,x=RegExp("^"+E.call(T).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),A=y?p.Buffer:void 0,k=O.propertyIsEnumerable,q=A?A.isBuffer:void 0,D=(g=Object.keys,m=Object,function(t){return g(m(t))}),$=G(p,"DataView"),I=G(p,"Map"),_=G(p,"Promise"),B=G(p,"Set"),M=G(p,"WeakMap"),N=!k.call({valueOf:1},"valueOf"),C=L($),F=L(I),K=L(_),R=L(B),W=L(M);function H(t){return!(!Y(t)||function(t){return!!S&&S in t}(t))&&(X(t)||function(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}(t)?x:s).test(L(t))}function G(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return H(r)?r:void 0}var J=function(t){return P.call(t)};function L(t){if(null!=t){try{return E.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function V(t){return function(t){return function(t){return!!t&&"object"==c(t)}(t)&&Q(t)}(t)&&T.call(t,"callee")&&(!k.call(t,"callee")||"[object Arguments]"==P.call(t))}($&&J(new $(new ArrayBuffer(1)))!=l||I&&J(new I)!=n||_&&J(_.resolve())!=i||B&&J(new B)!=a||M&&J(new M)!=u)&&(J=function(t){var e=P.call(t),r="[object Object]"==e?t.constructor:void 0,o=r?L(r):void 0;if(o)switch(o){case C:return l;case F:return n;case K:return i;case R:return a;case W:return u}return e});var z=Array.isArray;function Q(t){return null!=t&&function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=r}(t.length)&&!X(t)}var U=q||function(){return!1};function X(t){var e=Y(t)?P.call(t):"";return"[object Function]"==e||"[object GeneratorFunction]"==e}function Y(t){var e=c(t);return!!t&&("object"==e||"function"==e)}t.exports=function(t){if(Q(t)&&(z(t)||"string"==typeof t||"function"==typeof t.splice||U(t)||V(t)))return!t.length;var e=J(t);if(e==n||e==a)return!t.size;if(N||function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||O)}(t))return!D(t).length;for(var r in t)if(T.call(t,r))return!1;return!0}})),P={autoInit:!1,dataScroll:"scroll-stash",dataAnchor:"scroll-stash-anchor",selectorAnchor:"",selectorAnchorParent:"",selectorTopElem:"",selectorBotElem:"",alignment:"nearest",behavior:"auto",anchorPadding:16,saveKey:"ScrollStash",throttleDelay:100,customEventPrefix:"scroll-stash:"},x=function(t,e,r){var n=r.anchorPadding;if(r.selectorTopElem){var o=t.querySelector(r.selectorTopElem);o&&(n+=o.offsetHeight)}return e.offsetTop-n},A=function(t,e,r){var n=r.anchorPadding;if(r.selectorBotElem){var o=t.querySelector(r.selectorBotElem);o&&(n+=o.offsetHeight)}return e.offsetTop-(t.offsetHeight-(e.offsetHeight+n))},k=function(t,e,r){var n=function(t,e,r){var n=x(t,e,r),o=A(t,e,r);return!(t.scrollTop>n||t.scrollTop<o)}(t,e,r);switch(r.alignment){case"start":return!n&&x(t,e,r);case"center":return!n&&function(t,e,r){var n=x(t,e,r),o=A(t,e,r);return o+(n-o)/2}(t,e,r);case"end":return!n&&A(t,e,r);case"nearest":return function(t,e,r){var n=x(t,e,r),o=A(t,e,r);return t.scrollTop>n?n:t.scrollTop<o&&o}(t,e,r);default:return!1}},q=function(t,e){var r=t.getAttribute("data-".concat(e.dataAnchor));if("false"==r||"ignore"==r)return null;if(r&&t.querySelector(r))return t.querySelector(r);var n=e.selectorAnchor?t.querySelector(e.selectorAnchor):null;if(n&&e.selectorAnchorParent){var o=n.closest(e.selectorAnchorParent);if(o)return o}return n||null},D=function(t,e,r){var n=q(t,r);if(n){var o=k(t,n,r);return o?(e=e||r.behavior,t.scroll({top:o,behavior:e}),t.dispatchEvent(new CustomEvent(r.customEventPrefix+"anchor",{bubbles:!0,detail:{scrolled:{value:o,behavior:e},key:t.getAttribute("data-".concat(r.dataScroll))}})),{scrolled:{value:o,behavior:e},msg:"Anchor was scrolled into view"}):{scrolled:!1,msg:"Anchor is already in view"}}return{scrolled:!1,msg:"Anchor was not found"}},$=function(t){var e={};return document.querySelectorAll("[data-".concat(t.dataScroll,"]")).forEach((function(r){var n=r.getAttribute("data-".concat(t.dataScroll));n&&(e[n]=r.scrollTop)})),localStorage.setItem(t.saveKey,JSON.stringify(e)),document.dispatchEvent(new CustomEvent(t.customEventPrefix+"saved",{bubbles:!0,detail:{state:e}})),e},I=function(t){if(localStorage.getItem(t.saveKey)){var e=JSON.parse(localStorage.getItem(t.saveKey));return Object.keys(e).forEach((function(r){var n=document.querySelector("[data-".concat(t.dataScroll,'="').concat(r,'"]'));n&&(n.scrollTop=e[r])})),document.dispatchEvent(new CustomEvent(t.customEventPrefix+"applied",{bubbles:!0,detail:{state:e}})),e}return{}};function _(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function B(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?_(Object(n),!0).forEach((function(r){t(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}return function(){function t(r){e(this,t),this.settings=B(B({},P),r),this.state={},this.scrolls=[],this.throttleRef=E(this.handler,this.settings.throttleDelay,{leading:!1}).bind(this),this.settings.autoInit&&this.init()}return n(t,[{key:"init",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e&&(this.settings=B(B({},this.settings),e)),this.state=I(this.settings),this.state=T(this.state)?$(this.settings):this.state,this.scrolls=document.querySelectorAll("[data-".concat(this.settings.dataScroll,"]")),this.scrolls.forEach((function(e){e.addEventListener("scroll",t.throttleRef),D(e,!1,t.settings)}))}},{key:"destroy",value:function(){var t=this;this.scrolls.forEach((function(e){e.removeEventListener("scroll",t.throttleRef)})),this.state={},this.scrolls=[],localStorage.removeItem(this.settings.saveKey)}},{key:"handler",value:function(){this.state=$(this.settings)}},{key:"anchorGet",value:function(t){return q(t,this.settings)}},{key:"anchorShow",value:function(t,e){return D(t,e,this.settings)}}]),t}()}));
