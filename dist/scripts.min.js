!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).ScrollStash=e()}(this,(function(){"use strict";var t=function(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t};var e=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")};function r(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var n=function(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t},o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function i(t,e,r){return t(r={path:e,exports:{},require:function(t,e){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==e&&r.path)}},r.exports),r.exports}var c=i((function(t){function e(r){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?t.exports=e=function(t){return typeof t}:t.exports=e=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(r)}t.exports=e})),a=/^\s+|\s+$/g,u=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,s=/^0o[0-7]+$/i,f=parseInt,p="object"==c(o)&&o&&o.Object===Object&&o,h="object"==("undefined"==typeof self?"undefined":c(self))&&self&&self.Object===Object&&self,v=p||h||Function("return this")(),d=Object.prototype.toString,y=Math.max,b=Math.min,g=function(){return v.Date.now()};function m(t,e,r){var n,o,i,c,a,u,l=0,s=!1,f=!1,p=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function h(e){var r=n,i=o;return n=o=void 0,l=e,c=t.apply(i,r)}function v(t){return l=t,a=setTimeout(m,e),s?h(t):c}function d(t){var r=t-u;return void 0===u||r>=e||r<0||f&&t-l>=i}function m(){var t=g();if(d(t))return O(t);a=setTimeout(m,function(t){var r=e-(t-u);return f?b(r,i-(t-l)):r}(t))}function O(t){return a=void 0,p&&n?h(t):(n=o=void 0,c)}function S(){var t=g(),r=d(t);if(n=arguments,o=this,u=t,r){if(void 0===a)return v(u);if(f)return a=setTimeout(m,e),h(u)}return void 0===a&&(a=setTimeout(m,e)),c}return e=w(e)||0,j(r)&&(s=!!r.leading,i=(f="maxWait"in r)?y(w(r.maxWait)||0,e):i,p="trailing"in r?!!r.trailing:p),S.cancel=function(){void 0!==a&&clearTimeout(a),l=0,n=u=o=a=void 0},S.flush=function(){return void 0===a?c:O(g())},S}function j(t){var e=c(t);return!!t&&("object"==e||"function"==e)}function O(t){return"symbol"==c(t)||function(t){return!!t&&"object"==c(t)}(t)&&"[object Symbol]"==d.call(t)}function w(t){if("number"==typeof t)return t;if(O(t))return NaN;if(j(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=j(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(a,"");var r=l.test(t);return r||s.test(t)?f(t.slice(2),r?2:8):u.test(t)?NaN:+t}var S=function(t,e,r){var n=!0,o=!0;if("function"!=typeof t)throw new TypeError("Expected a function");return j(r)&&(n="leading"in r?!!r.leading:n,o="trailing"in r?!!r.trailing:o),m(t,e,{leading:n,maxWait:e,trailing:o})},E=i((function(t,e){var r="[object Map]",n="[object Set]",i=/^\[object .+?Constructor\]$/,a="object"==c(o)&&o&&o.Object===Object&&o,u="object"==("undefined"==typeof self?"undefined":c(self))&&self&&self.Object===Object&&self,l=a||u||Function("return this")(),s=e&&!e.nodeType&&e,f=s&&t&&!t.nodeType&&t,p=f&&f.exports===s;var h,v,d,y=Function.prototype,b=Object.prototype,g=l["__core-js_shared__"],m=(h=/[^.]+$/.exec(g&&g.keys&&g.keys.IE_PROTO||""))?"Symbol(src)_1."+h:"",j=y.toString,O=b.hasOwnProperty,w=b.toString,S=RegExp("^"+j.call(O).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),E=p?l.Buffer:void 0,P=b.propertyIsEnumerable,T=E?E.isBuffer:void 0,x=(v=Object.keys,d=Object,function(t){return v(d(t))}),A=F(l,"DataView"),k=F(l,"Map"),D=F(l,"Promise"),q=F(l,"Set"),$=F(l,"WeakMap"),I=!P.call({valueOf:1},"valueOf"),M=R(A),_=R(k),B=R(D),C=R(q),N=R($);function W(t){return!(!L(t)||function(t){return!!m&&m in t}(t))&&(J(t)||function(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}(t)?S:i).test(R(t))}function F(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return W(r)?r:void 0}var K=function(t){return w.call(t)};function R(t){if(null!=t){try{return j.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function H(t){return function(t){return function(t){return!!t&&"object"==c(t)}(t)&&z(t)}(t)&&O.call(t,"callee")&&(!P.call(t,"callee")||"[object Arguments]"==w.call(t))}(A&&"[object DataView]"!=K(new A(new ArrayBuffer(1)))||k&&K(new k)!=r||D&&"[object Promise]"!=K(D.resolve())||q&&K(new q)!=n||$&&"[object WeakMap]"!=K(new $))&&(K=function(t){var e=w.call(t),o="[object Object]"==e?t.constructor:void 0,i=o?R(o):void 0;if(i)switch(i){case M:return"[object DataView]";case _:return r;case B:return"[object Promise]";case C:return n;case N:return"[object WeakMap]"}return e});var V=Array.isArray;function z(t){return null!=t&&function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}(t.length)&&!J(t)}var G=T||function(){return!1};function J(t){var e=L(t)?w.call(t):"";return"[object Function]"==e||"[object GeneratorFunction]"==e}function L(t){var e=c(t);return!!t&&("object"==e||"function"==e)}t.exports=function(t){if(z(t)&&(V(t)||"string"==typeof t||"function"==typeof t.splice||G(t)||H(t)))return!t.length;var e=K(t);if(e==r||e==n)return!t.size;if(I||function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||b)}(t))return!x(t).length;for(var o in t)if(O.call(t,o))return!1;return!0}})),P={autoInit:!1,dataScroll:"scroll-stash",dataAnchor:"scroll-stash-anchor",selectorAnchor:"",selectorAnchorParent:"",selectorTopElem:"",selectorBotElem:"",alignment:"nearest",behavior:"auto",anchorPadding:16,saveKey:"ScrollStash",throttleDelay:100,customEventPrefix:"scroll-stash:"},T=function(t){return t.replace(/-([a-z])/g,(function(t){return t[1].toUpperCase()}))},x=function(t,e,r){var n=r.anchorPadding;if(r.selectorTopElem){var o=t.querySelector(r.selectorTopElem);o&&(n+=o.offsetHeight)}return e.offsetTop-n},A=function(t,e,r){var n=r.anchorPadding;if(r.selectorBotElem){var o=t.querySelector(r.selectorBotElem);o&&(n+=o.offsetHeight)}return e.offsetTop-(t.offsetHeight-(e.offsetHeight+n))},k=function(t,e,r){var n=function(t,e,r){var n=x(t,e,r),o=A(t,e,r);return!(t.scrollTop>n||t.scrollTop<o)}(t,e,r);switch(r.alignment){case"start":return!n&&x(t,e,r);case"center":return!n&&function(t,e,r){var n=x(t,e,r),o=A(t,e,r);return o+(n-o)/2}(t,e,r);case"end":return!n&&A(t,e,r);case"nearest":return function(t,e,r){var n=x(t,e,r),o=A(t,e,r);return t.scrollTop>n?n:t.scrollTop<o&&o}(t,e,r);default:return!1}},D=function(t,e){var r=t.dataset[T(e.dataAnchor)];if("false"==r||"ignore"==r)return null;if(r&&t.querySelector(r))return t.querySelector(r);var n=e.selectorAnchor?t.querySelector(e.selectorAnchor):null;if(n&&e.selectorAnchorParent){var o=n.closest(e.selectorAnchorParent);if(o)return o}return n||null},q=function(t,e,r){var n=D(t,r);if(n){var o=k(t,n,r);return o?(e=e||r.behavior,t.scroll({top:o,behavior:e}),t.dispatchEvent(new CustomEvent(r.customEventPrefix+"anchor",{bubbles:!0,detail:{scrolled:{value:o,behavior:e},key:t.dataset[T(r.dataScroll)]}})),{scrolled:{value:o,behavior:e},msg:"Anchor was scrolled into view"}):{scrolled:!1,msg:"Anchor is already in view"}}return{scrolled:!1,msg:"Anchor was not found"}},$=function(t){var e={};return document.querySelectorAll("[data-".concat(t.dataScroll,"]")).forEach((function(r){var n=r.dataset[T(t.dataScroll)];n&&(e[n]=r.scrollTop)})),localStorage.setItem(t.saveKey,JSON.stringify(e)),document.dispatchEvent(new CustomEvent(t.customEventPrefix+"saved",{bubbles:!0,detail:{state:e}})),e},I=function(t){if(localStorage.getItem(t.saveKey)){var e=JSON.parse(localStorage.getItem(t.saveKey));return Object.keys(e).forEach((function(r){var n=document.querySelector("[data-".concat(t.dataScroll,'="').concat(r,'"]'));n&&(n.scrollTop=e[r])})),document.dispatchEvent(new CustomEvent(t.customEventPrefix+"applied",{bubbles:!0,detail:{state:e}})),e}return{}};function M(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function _(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?M(Object(n),!0).forEach((function(r){t(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}return function(){function t(r){e(this,t),this.settings=_(_({},P),r),this.state={},this.scrolls=[],this.throttleRef=S(this.handler,this.settings.throttleDelay,{leading:!1}).bind(this),this.settings.autoInit&&this.init()}return n(t,[{key:"init",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e&&(this.settings=_(_({},this.settings),e)),this.state=I(this.settings),this.state=E(this.state)?$(this.settings):this.state,this.scrolls=document.querySelectorAll("[data-".concat(this.settings.dataScroll,"]")),this.scrolls.forEach((function(e){e.addEventListener("scroll",t.throttleRef),q(e,!1,t.settings)}))}},{key:"destroy",value:function(){var t=this;this.scrolls.forEach((function(e){e.removeEventListener("scroll",t.throttleRef)})),this.state={},this.scrolls=[],localStorage.removeItem(this.settings.saveKey)}},{key:"handler",value:function(){this.state=$(this.settings)}},{key:"anchorGet",value:function(t){return D(t,this.settings)}},{key:"anchorShow",value:function(t,e){return q(t,e,this.settings)}}]),t}()}));
